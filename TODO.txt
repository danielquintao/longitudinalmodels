/!\ replace asserts by raise ValueError (asserts are removed when python is run in optimized mode -O)